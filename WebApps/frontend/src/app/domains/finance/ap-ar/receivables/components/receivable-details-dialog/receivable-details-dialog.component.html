<p-dialog
  [visible]="visible"
  (visibleChange)="visibleChange.emit($event)"
  [modal]="true"
  appendTo="body"
  maskStyleClass="receivables-dialog-mask"
  [baseZIndex]="1200"
  [blockScroll]="true"
  [draggable]="false"
  [resizable]="false"
  [dismissableMask]="true"
  [style]="{ width: 'min(980px, 96vw)' }"
  [breakpoints]="{ '1200px': '96vw', '900px': '98vw', '640px': '100vw' }"
  [contentStyle]="{ 'max-height': '82vh', 'overflow-y': 'auto' }"
  styleClass="receivables-dialog"
  [header]="'receivables.details.title' | translate">
  <ng-container *ngIf="row as current">
    <div class="details-grid">
      <section class="details-section">
        <h4>{{ 'receivables.details.sections.service' | translate }}</h4>
        <div class="detail-row">
          <span>{{ 'receivables.customer' | translate }}</span>
          <strong>{{ current.customerName || '-' }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.service' | translate }}</span>
          <strong>{{ current.serviceDescription || '-' }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.serviceDate' | translate }}</span>
          <strong>{{ formatDate(current.serviceDate) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.serviceOrderNumber' | translate }}</span>
          <strong>{{ current.serviceOrderNumber || '-' }}</strong>
        </div>
      </section>

      <section class="details-section">
        <h4>{{ 'receivables.details.sections.document' | translate }}</h4>
        <div class="detail-row">
          <span>{{ 'receivables.list.invoiceNumber' | translate }}</span>
          <strong>{{ current.invoiceNumber || '-' }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.invoiceIssueDate' | translate }}</span>
          <strong>{{ formatDate(current.invoiceIssueDate) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.dueDate' | translate }}</span>
          <strong>{{ formatDate(current.dueDate) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.paymentMethod' | translate }}</span>
          <strong>{{ paymentMethodLabel(current.paymentMethod) }}</strong>
        </div>
      </section>

      <section class="details-section">
        <h4>{{ 'receivables.details.sections.financial' | translate }}</h4>
        <div class="detail-row">
          <span>{{ 'receivables.list.grossAmount' | translate }}</span>
          <strong>{{ formatMoney(current.grossAmount, current.currencyCode) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.issAmount' | translate }}</span>
          <strong>{{ formatMoney(current.issAmount, current.currencyCode) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.inssAmount' | translate }}</span>
          <strong>{{ formatMoney(current.inssAmount, current.currencyCode) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.netAmount' | translate }}</span>
          <strong>{{ formatMoney(netAmountValue(current), current.currencyCode) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.amountReceived' | translate }}</span>
          <strong>{{ formatMoney(current.amountReceived, current.currencyCode) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.list.outstandingAmount' | translate }}</span>
          <strong>{{ formatMoney(outstandingAmountValue(current), current.currencyCode) }}</strong>
        </div>
      </section>

      <section class="details-section">
        <h4>{{ 'receivables.details.sections.control' | translate }}</h4>
        <div class="detail-row">
          <span>{{ 'receivables.list.paid' | translate }}</span>
          <strong><span [class]="paidClass(current)">{{ isPaid(current) ? 'OK' : '-' }}</span></strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.form.paymentDate' | translate }}</span>
          <strong>{{ formatDate(current.paymentDate) }}</strong>
        </div>
        <div class="detail-row">
          <span>{{ 'receivables.status' | translate }}</span>
          <strong><span [class]="statusClass(current.status)">{{ statusKey(current.status) | translate }}</span></strong>
        </div>
      </section>
    </div>
  </ng-container>
  <ng-template pTemplate="footer">
    <button pButton type="button" class="brand-button ghost" (click)="close()">
      {{ 'common.close' | translate }}
    </button>
    <button
      pButton
      type="button"
      class="brand-button"
      [disabled]="!row || !canEdit(row)"
      (click)="row && edit.emit(row)">
      {{ 'receivables.list.edit' | translate }}
    </button>
  </ng-template>
</p-dialog>
